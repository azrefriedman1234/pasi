{% extends "layout.html" %}
{% block content %}

<div class="screen settings-screen">
    <h1 class="screen-title">הגדרות מערכת</h1>

    <form method="post" enctype="multipart/form-data" class="settings-form">

        <section class="settings-section">
            <h2>חיבור לטלגרם</h2>

            <div class="form-row">
                <label for="telegram_api_id">Telegram API ID</label>
                <input type="text" id="telegram_api_id" name="telegram_api_id"
                       value="{{ settings.telegram_api_id }}" placeholder="לדוגמה: 1234567">
            </div>

            <div class="form-row">
                <label for="telegram_api_hash">Telegram API Hash</label>
                <input type="text" id="telegram_api_hash" name="telegram_api_hash"
                       value="{{ settings.telegram_api_hash }}" placeholder="hash מה- my.telegram.org">
            </div>

            <div class="form-row">
                <label for="telegram_phone">טלפון לחשבון טלגרם</label>
                <input type="text" id="telegram_phone" name="telegram_phone"
                       value="{{ settings.telegram_phone }}" placeholder="+9725...">
            </div>

            <div class="form-row">
                <label for="telegram_password">סיסמת 2FA (אם יש)</label>
                <input type="password" id="telegram_password" name="telegram_password"
                       value="{{ settings.telegram_password }}">
            </div>

            <div class="form-row">
                <label for="telegram_target">יעד לשליחה (user / channel / @handle)</label>
                <input type="text" id="telegram_target" name="telegram_target"
                       value="{{ settings.telegram_target }}" placeholder="@my_channel">
            </div>

            <div class="form-row">
                <label for="telegram_sources">ערוצי מקור (רשימה מופרדת בפסיקים)</label>
                <input type="text" id="telegram_sources" name="telegram_sources"
                       value="{{ settings.telegram_sources }}" placeholder="@source1,@source2">
            </div>

            <div class="form-row buttons-row">
                <button type="submit" name="action" value="send_code" class="btn primary">
                    שליחת קוד לטלגרם
                </button>

                <div class="code-block">
                    <label for="login_code">קוד אימות מטלגרם</label>
                    <input type="text" id="login_code" name="login_code" placeholder="12345">
                </div>

                <button type="submit" name="action" value="login" class="btn success">
                    אישור התחברות
                </button>
            </div>

            <p class="hint">
                אם קוד האימות פג תוקף – שלח שוב קוד דרך הכפתור הראשון והשתמש בקוד האחרון שמגיע.
            </p>
        </section>

        <section class="settings-section">
            <h2>פייסבוק</h2>

            <div class="form-row">
                <label for="facebook_page_token">Facebook Page Token</label>
                <input type="text" id="facebook_page_token" name="facebook_page_token"
                       value="{{ settings.facebook_page_token }}">
            </div>

            <div class="form-row">
                <label for="facebook_page_id">Facebook Page ID</label>
                <input type="text" id="facebook_page_id" name="facebook_page_id"
                       value="{{ settings.facebook_page_id }}">
            </div>
        </section>

        <section class="settings-section">
            <h2>סימן מים (Watermark)</h2>

            <div class="form-row">
                <label for="watermark_image">תמונת סימן מים</label>
                <input type="file" id="watermark_image" name="watermark_image" accept="image/*">
            </div>

            {% if watermark_exists %}
            <p class="hint">
                ✔ סימן מים שמור כבר במערכת (watermark.png)
            </p>
            {% else %}
            <p class="hint">
                עדיין לא הוגדר סימן מים. מומלץ להעלות תמונה (לוגו) פעם אחת.
            </p>
            {% endif %}
        </section>

        <section class="settings-section">
            <div class="form-row">
                <button type="submit" name="action" value="save" class="btn secondary full-width">
                    שמירת הגדרות
                </button>
            </div>
        </section>
    </form>
</div>

{% endblock %}
